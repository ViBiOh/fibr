{{ define "layout" }}
  {{ $root := . }}

  {{ template "navigation" . }}

  <header class="header full-screen flex flex-center">
    <span class="flex-grow flex-ellipsis">
      <h1 class="medium no-margin no-padding breakable" itemscope itemtype="http://schema.org/BreadcrumbList">
        <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          {{ template "root-link" . }}
        </span>

        {{ range $index, $path := .Paths }}
          {{ if or (not $root.Request.Share.ID) (ne $index 0) }}
            {{ $fullPath := rebuildPaths $root.Paths $index }}

            <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
               / 
              <a href="{{ url $fullPath }}?d={{ $root.Request.LayoutPath $fullPath }}" itemprop="item">
                <span itemprop="name">{{ $path }}</span>
              </a>
            </span>
          {{ end }}
        {{ end }}
      </h1>

    {{ if .File }}
        {{ if not .Request.Share.File }}
          <h2 class="small bg-grey no-margin full ellipsis">
            ↳&nbsp;
            <a href="{{ .File.Name }}">{{ .File.Name }}</a>
          </h2>
        {{ end }}
      </span>

      {{ if not (and .Previous.IsZero .Next.IsZero) }}
        <nav class="flex">
          {{ if not .Previous.IsZero }}
            <a class="button button-icon" href="{{ url (.Request.AbsoluteURL .Previous.URL) }}?browser">
              <img class="icon" src="{{ url "/svg/arrow-left?fill=aliceblue" }}" alt="Previous file">
            </a>
          {{ end }}

          {{ if not .Next.IsZero }}
            <a class="button button-icon" href="{{ url (.Request.AbsoluteURL .Next.URL) }}?browser">
              <img class="icon" src="{{ url "/svg/arrow-right?fill=aliceblue" }}" alt="Next file">
            </a>
          {{ end }}
        </nav>
      {{ end }}
    {{ else }}
      </span>
      {{ if not .Request.Share.Story }}
        <a class="padding" href="#search" download>
          <img class="icon" src="{{ url "/svg/search?fill=" }}{{ if .Search }}limegreen{{ else }}aliceblue{{ end }}" alt="Search files">
        </a>
      {{ end }}
    {{ end }}
  </header>

  <style type="text/css" nonce="{{ .nonce }}">
    .breakable {
      word-break: break-word;
    }
  </style>

  {{ if .Message }}
    {{ template "message" .Message }}
  {{ end }}
{{ end }}
