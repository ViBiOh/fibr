function __swcpack_require__(mod){function interop(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var cache;if(cache){return cache}var module={exports:{}};mod(module,module.exports);cache=interop(module.exports);return cache}function AsyncGenerator(gen){var front,back;function send(key,arg){return new Promise(function(resolve,reject){var request={key:key,arg:arg,resolve:resolve,reject:reject,next:null};if(back){back=back.next=request}else{front=back=request;resume(key,arg)}})}function resume(key,arg){try{var result=gen[key](arg);var value=result.value;var wrappedAwait=value instanceof _AwaitValue;Promise.resolve(wrappedAwait?value.wrapped:value).then(function(arg){if(wrappedAwait){resume("next",arg);return}settle(result.done?"return":"normal",arg)},function(err){resume("throw",err)})}catch(err){settle("throw",err)}}function settle(type,value){switch(type){case"return":front.resolve({value:value,done:true});break;case"throw":front.reject(value);break;default:front.resolve({value:value,done:false});break}front=front.next;if(front){resume(front.key,front.arg)}else{back=null}}this._invoke=send;if(typeof gen.return!=="function"){this.return=undefined}}if(typeof Symbol==="function"&&Symbol.asyncIterator){AsyncGenerator.prototype[Symbol.asyncIterator]=function(){return this}}AsyncGenerator.prototype.next=function(arg){return this._invoke("next",arg)};AsyncGenerator.prototype.throw=function(arg){return this._invoke("throw",arg)};AsyncGenerator.prototype.return=function(arg){return this._invoke("return",arg)};function _asyncIterator(iterable){var method;if(typeof Symbol==="function"){if(Symbol.asyncIterator){method=iterable[Symbol.asyncIterator];if(method!=null)return method.call(iterable)}if(Symbol.iterator){method=iterable[Symbol.iterator];if(method!=null)return method.call(iterable)}}throw new TypeError("Object is not async iterable")}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _awaitAsyncGenerator(value){return new _AwaitValue(value)}function _AwaitValue(value){this.wrapped=value}function _wrapAsyncGenerator(fn){return function(){return new AsyncGenerator(fn.apply(this,arguments))}}var load=__swcpack_require__.bind(void 0,function(module,exports){var runtime=function(exports){"use strict";var Op=Object.prototype;var hasOwn=Op.hasOwnProperty;var undefined;var $Symbol=typeof Symbol==="function"?Symbol:{};var iteratorSymbol=$Symbol.iterator||"@@iterator";var asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator";var toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});return obj[key]}try{define({},"")}catch(err){define=function(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator;var generator=Object.create(protoGenerator.prototype);var context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator}exports.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this});var getProto=Object.getPrototypeOf;var NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol))IteratorPrototype=NativeIteratorPrototype;var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=GeneratorFunctionPrototype;define(Gp,"constructor",GeneratorFunctionPrototype);define(GeneratorFunctionPrototype,"constructor",GeneratorFunction);GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction");function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg)})})}exports.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};exports.mark=function(genFun){if(Object.setPrototypeOf)Object.setPrototypeOf(genFun,GeneratorFunctionPrototype);else{genFun.__proto__=GeneratorFunctionPrototype;define(genFun,toStringTagSymbol,"GeneratorFunction")}genFun.prototype=Object.create(Gp);return genFun};exports.awrap=function(arg){return{__await:arg}};function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(record.type==="throw")reject(record.arg);else{var result=record.arg;var value=result.value;if(value&& typeof value==="object"&&hasOwn.call(value,"__await"))return PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)});return PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped;resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}}var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}this._invoke=enqueue}defineIteratorMethods(AsyncIterator.prototype);define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this});exports.AsyncIterator=AsyncIterator;exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){if(PromiseImpl===void 0)PromiseImpl=Promise;var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting)throw new Error("Generator is already running");if(state===GenStateCompleted){if(method==="throw")throw arg;return doneResult()}context.method=method;context.arg=arg;while(true){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if(context.method==="next")context.sent=context._sent=context.arg;else if(context.method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg}context.dispatchException(context.arg)}else if(context.method==="return")context.abrupt("return",context.arg);state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}else if(record.type==="throw"){state=GenStateCompleted;context.method="throw";context.arg=record.arg}}}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){context.delegate=null;if(context.method==="throw"){if(delegate.iterator["return"]){context.method="return";context.arg=undefined;maybeInvokeDelegate(delegate,context);if(context.method==="throw")return ContinueSentinel}context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if(record.type==="throw"){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel}var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel}if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if(context.method!=="return"){context.method="next";context.arg=undefined}}else return info;context.delegate=null;return ContinueSentinel}defineIteratorMethods(Gp);define(Gp,toStringTagSymbol,"Generator");define(Gp,iteratorSymbol,function(){return this});define(Gp,"toString",function(){return"[object Generator]"});function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs)entry.catchLoc=locs[1];if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(true)}exports.keys=function(object){var keys=[];for(var key in object)keys.push(key);keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if(typeof iterable.next==="function")return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length)if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}exports.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=undefined;this.done=false;this.delegate=null;this.method="next";this.arg=undefined;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this)if(name.charAt(0)==="t"&&hasOwn.call(this,name)&&!isNaN(+name.slice(1)))this[name]=undefined}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw")throw rootRecord.arg;return this.rval},dispatchException:function(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=undefined}return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root")return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,true);else if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,true)}else if(hasFinally){if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc)finallyEntry=null;var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel}return this.complete(record)},complete:function(record,afterLoc){if(record.type==="throw")throw record.arg;if(record.type==="break"||record.type==="continue")this.next=record.arg;else if(record.type==="return"){this.rval=this.arg=record.arg;this.method="return";this.next="end"}else if(record.type==="normal"&&afterLoc)this.next=afterLoc;return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel}}},"catch":function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if(this.method==="next")this.arg=undefined;return ContinueSentinel}};return exports}(typeof module==="object"?module.exports:{});try{regeneratorRuntime=runtime}catch(accidentalStrictMode){if(typeof globalThis==="object")globalThis.regeneratorRuntime=runtime;else Function("r","regeneratorRuntime = r")(runtime)}});var{default:regeneratorRuntime1}=load();function readLineByLine(response){return _readLineByLine.apply(this,arguments)}function _readLineByLine(){_readLineByLine=_wrapAsyncGenerator(regeneratorRuntime1.mark(function _callee(response){var utf8Decoder,reader,ref,chunk,readerDone,re,startIndex,result,remainder,ref1;return regeneratorRuntime1.wrap(function _callee$(_ctx){while(1)switch(_ctx.prev=_ctx.next){case 0:utf8Decoder=new TextDecoder("utf-8");reader=response.body.getReader();_ctx.next=4;return _awaitAsyncGenerator(reader.read());case 4:ref=_ctx.sent;chunk=ref.value;readerDone=ref.done;chunk=chunk?utf8Decoder.decode(chunk,{stream:true}):"";re=/\r\n|\n|\r/gm;startIndex=0;case 10:result=re.exec(chunk);if(result){_ctx.next=25;break}if(!readerDone){_ctx.next=14;break}return _ctx.abrupt("break",30);case 14:remainder=chunk.substr(startIndex);_ctx.next=18;return _awaitAsyncGenerator(reader.read());case 18:ref1=_ctx.sent;chunk=ref1.value;readerDone=ref1.done;chunk=remainder+(chunk?utf8Decoder.decode(chunk,{stream:true}):"");startIndex=re.lastIndex=0;return _ctx.abrupt("continue",28);case 25:_ctx.next=27;return chunk.substring(startIndex,result.index);case 27:startIndex=re.lastIndex;case 28:_ctx.next=10;break;case 30:if(!(startIndex<chunk.length)){_ctx.next=33;break}_ctx.next=33;return chunk.substr(startIndex);case 33:case"end":return _ctx.stop()}},_callee)}));return _readLineByLine.apply(this,arguments)}function fetchThumbnail(){return _fetchThumbnail.apply(this,arguments)}function _fetchThumbnail(){_fetchThumbnail=_asyncToGenerator(regeneratorRuntime1.mark(function _callee(){var response,_iteratorAbruptCompletion,_didIteratorError,_iteratorError,_iterator,_step,_value,line,parts,picture,img;return regeneratorRuntime1.wrap(function _callee$(_ctx){while(1)switch(_ctx.prev=_ctx.next){case 0:fetchURL=document.location.search;if(fetchURL.includes("?"))fetchURL+="&thumbnail";else fetchURL+="?thumbnail";_ctx.next=4;return fetch(fetchURL,{credentials:"same-origin"});case 4:response=_ctx.sent;if(!(response.status>=400)){_ctx.next=7;break}throw new Error("unable to load thumbnails");case 7:_iteratorAbruptCompletion=false,_didIteratorError=false;_ctx.prev=8;_iterator=_asyncIterator(readLineByLine(response));case 10:_ctx.next=12;return _iterator.next();case 12:if(!(_iteratorAbruptCompletion=!(_step=_ctx.sent).done)){_ctx.next=31;break}_value=_step.value;line=_value;parts=line.split(",");if(!(parts.length!=2)){_ctx.next=19;break}console.error("invalid line for thumbnail:",line);return _ctx.abrupt("continue",28);case 19:picture=document.getElementById("picture-".concat(parts[0]));if(picture){_ctx.next=22;break}return _ctx.abrupt("continue",28);case 22:img=new Image;img.src="data:image/webp;base64,".concat(parts[1]);img.alt=picture.dataset.alt;img.dataset.src=picture.dataset.src;img.classList.add("thumbnail","full","block");replaceContent(picture,img);case 28:_iteratorAbruptCompletion=false;_ctx.next=10;break;case 31:_ctx.next=37;break;case 33:_ctx.prev=33;_ctx.t0=_ctx["catch"](8);_didIteratorError=true;_iteratorError=_ctx.t0;case 37:_ctx.prev=37;_ctx.prev=38;if(!(_iteratorAbruptCompletion&&_iterator.return!=null)){_ctx.next=42;break}_ctx.next=42;return _iterator.return();case 42:_ctx.prev=42;if(!_didIteratorError){_ctx.next=45;break}throw _iteratorError;case 45:return _ctx.finish(42);case 46:return _ctx.finish(37);case 47:case"end":return _ctx.stop()}},_callee,null,[[8,33,37,47],[38,,42,46]])}));return _fetchThumbnail.apply(this,arguments)}window.addEventListener("load",_asyncToGenerator(regeneratorRuntime1.mark(function _callee(){var thumbnailsElem;return regeneratorRuntime1.wrap(function _callee$(_ctx){while(1)switch(_ctx.prev=_ctx.next){case 0:thumbnailsElem=document.querySelectorAll("[data-thumbnail]");if(thumbnailsElem){_ctx.next=3;break}return _ctx.abrupt("return");case 3:_ctx.prev=3;_ctx.next=6;return isWebPCompatible();case 6:_ctx.next=13;break;case 8:_ctx.prev=8;_ctx.t0=_ctx["catch"](3);console.error("Your browser is not compatible with WebP format.",_ctx.t0);thumbnailsElem.forEach(displayNoThumbnail);return _ctx.abrupt("return");case 13:thumbnailsElem.forEach(function(picture){replaceContent(picture,generateThrobber(["throbber-white"]))});_ctx.prev=14;_ctx.next=17;return fetchThumbnail();case 17:window.dispatchEvent(new Event("thumbnail-done"));_ctx.next=23;break;case 20:_ctx.prev=20;_ctx.t1=_ctx["catch"](14);console.error(_ctx.t1);case 23:case"end":return _ctx.stop()}},_callee,null,[[3,8],[14,20]])})),false)